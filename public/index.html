<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Jewelry Store</title>
    <link rel="stylesheet" href="./style.css" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.0/css/all.min.css" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/css/bootstrap.min.css" />
  </head>

  <body class="bg-light text-dark">
    <header
      class="row align-items-center py-3 text-light"
      style="width: 100%; margin: 0; background-color: #d4af37">
      <div class="col-6 d-flex align-items-center">
        <button class="btn btn-outline-light d-md-none me-2" id="sidebarToggle">
          <i class="fas fa-bars"></i>
        </button>
        <h1 class="h4 m-0">Claudine Joaillerie</h1>
      </div>
      <div class="col-6 text-end" id="authSection">
      </div>
    </header>

    <div class="container-fluid">
      <div class="row">
        <div class="col-md-3 col-lg-2 sidebar py-3" id="sidebar">
          <h5 class="mb-3 px-3">Collections</h5>
          <div id="categoryList" class="d-flex flex-column gap-1 px-2"></div>
        </div>

        <main class="col-md-9 col-lg-10 px-4 py-3">
          <div class="d-flex justify-content-between align-items-center mb-4">
            <h4 id="currentCollection">All</h4>
            <div class="dropdown">
              <button
                class="btn btn-outline-secondary dropdown-toggle sort-dropdown"
                type="button"
                id="sortDropdown"
                data-bs-toggle="dropdown">
                Sort By:
              </button>
              <ul class="dropdown-menu">
                <li><a class="dropdown-item" href="#" data-sort="price">Price</a></li>
                <li><a class="dropdown-item" href="#" data-sort="material">Material</a></li>
                <li><a class="dropdown-item" href="#" data-sort="popularity">Most Popular</a></li>
              </ul>
            </div>
          </div>
          <div id="jewelryContent" class="row row-cols-1 row-cols-sm-2 row-cols-lg-3 g-4"></div>
        </main>
      </div>
    </div>

    <div class="modal fade" id="loginModal" tabindex="-1" aria-labelledby="loginModalLabel" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="loginModalLabel">Login</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            <form id="loginForm">
              <div class="mb-3">
                <label for="loginEmail" class="form-label">Email address</label>
                <input type="email" class="form-control" id="loginEmail" required />
              </div>
              <div class="mb-3">
                <label for="loginPassword" class="form-label">Password</label>
                <input type="password" class="form-control" id="loginPassword" required />
              </div>
              <button type="submit" class="btn btn-primary w-100">Login</button>
            </form>
          </div>
        </div>
      </div>
    </div>

       <button class="btn btn-outline-dark position-fixed bottom-0 end-0 m-3" data-bs-toggle="modal" data-bs-target="#cartModal">
        ðŸ›’ Cart (<span id="cartCount">0</span>)
      </button>

    <div class="modal fade" id="cartModal" tabindex="-1" aria-labelledby="cartModalLabel" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="cartModalLabel">Your Cart</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            <div id="cartItems" class="cart-container"></div>
          </div>
          <div class="modal-footer">
            <h5>Total: $<span id="cartTotalModal">0.00</span></h5>
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
            <button type="button" class="btn btn-success">Checkout</button>
          </div>
        </div>
      </div>
    </div>

    <footer class="bg-dark text-light py-4 mt-5">
      <div class="container">
        <div class="row justify-content-center align-items-center">
          <div class="col-md-6 text-center mb-4">
            <h5 class="fw-bold mb-3">Contact Us</h5>
            <p>Phone: <span>87785549087</span></p>
            <p>Email: <span>contact@Claudine_Joaillerie.com</span></p>
            <p>Address: <span>Astana, Kazakhstan</span></p>
          </div>
        </div>
        <div class="text-center mt-4">
          <p class="mb-0">&copy; 2025 Claudine Joaillerie - Jewelry Store</p>
        </div>
      </div>
    </footer>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/js/bootstrap.bundle.min.js"></script>
    <script src="cart.js"></script>
    <script src="index.js"></script>

<div class="modal fade" id="signupModal" tabindex="-1" aria-labelledby="signupModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="signupModalLabel">Sign Up</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <form id="signupForm">
          <div class="mb-3">
            <label for="signupName" class="form-label">Name</label>
            <input type="text" class="form-control" id="signupName" required />
          </div>
          <div class="mb-3">
            <label for="signupEmail" class="form-label">Email</label>
            <input type="email" class="form-control" id="signupEmail" required />
          </div>
          <div class="mb-3">
            <label for="signupPassword" class="form-label">Password</label>
            <input type="password" class="form-control" id="signupPassword" required />
          </div>
          <button type="submit" class="btn btn-primary w-100">Sign Up</button>
        </form>
      </div>
    </div>
  </div>
</div>

<script>

  document.getElementById("loginForm").addEventListener("submit", async (e) => {
    e.preventDefault();
    const email = document.getElementById("loginEmail").value;
    const password = document.getElementById("loginPassword").value;

    try {
      const response = await fetch("/api/login", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ email, password }),
      });
      const data = await response.json();

      if (response.ok) {
        localStorage.setItem("token", data.token);
        location.reload();
      } else {
        alert("Login failed: " + data.error);
      }
    } catch (error) {
      console.error("Error logging in:", error);
    }
  });

  document.getElementById("signupForm").addEventListener("submit", async (e) => {
    e.preventDefault();
    const name = document.getElementById("signupName").value;
    const email = document.getElementById("signupEmail").value;
    const password = document.getElementById("signupPassword").value;

    try {
      const response = await fetch("/api/register", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ name, email, password }),
      });
      const data = await response.json();

      if (response.ok) {
        alert("Signup successful! Please log in.");
        document.getElementById("signupForm").reset();
        bootstrap.Modal.getInstance(document.getElementById("signupModal")).hide();
      } else {
        alert("Signup failed: " + data.error);
      }
    } catch (error) {
      console.error("Error signing up:", error);
    }
  });

  function checkAuth() {
    const authSection = document.getElementById("authSection");
    const token = localStorage.getItem("token");

    if (token) {
      authSection.innerHTML = '<button class="btn btn-outline-light" onclick="logout()">Logout</button>';
    } else {
      authSection.innerHTML = `
        <button class="btn btn-outline-light me-2" data-bs-toggle="modal" data-bs-target="#loginModal">Login</button>
        <button class="btn btn-outline-light" data-bs-toggle="modal" data-bs-target="#signupModal">Sign Up</button>
      `;
    }
  }

  function logout() {
    localStorage.removeItem("token");
    location.reload();
  }

  checkAuth();
</script>

  </body>
</html>